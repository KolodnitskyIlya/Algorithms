'''
D. Ğ”ĞµÑ‚ÑĞºĞ¸Ğ¹ Ğ¿Ñ€Ğ°Ğ·Ğ´Ğ½Ğ¸Ğº
Ğ¾Ğ³Ñ€Ğ°Ğ½Ğ¸Ñ‡ĞµĞ½Ğ¸Ğµ Ğ¿Ğ¾ Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ¸ Ğ½Ğ° Ñ‚ĞµÑÑ‚ 2 ÑĞµĞºÑƒĞ½Ğ´Ñ‹
Ğ¾Ğ³Ñ€Ğ°Ğ½Ğ¸Ñ‡ĞµĞ½Ğ¸Ğµ Ğ¿Ğ¾ Ğ¿Ğ°Ğ¼ÑÑ‚Ğ¸ Ğ½Ğ° Ñ‚ĞµÑÑ‚ 512 Ğ¼ĞµĞ³Ğ°Ğ±Ğ°Ğ¹Ñ‚
ĞÑ€Ğ³Ğ°Ğ½Ğ¸Ğ·Ğ°Ñ‚Ğ¾Ñ€Ñ‹ Ğ´ĞµÑ‚ÑĞºĞ¾Ğ³Ğ¾ Ğ¿Ñ€Ğ°Ğ·Ğ´Ğ½Ğ¸ĞºĞ° Ğ¿Ğ»Ğ°Ğ½Ğ¸Ñ€ÑƒÑÑ‚ Ğ½Ğ°Ğ´ÑƒÑ‚ÑŒ Ğ´Ğ»Ñ Ğ½ĞµĞ³Ğ¾ ğ‘š Ğ²Ğ¾Ğ·Ğ´ÑƒÑˆĞ½Ñ‹Ñ… ÑˆĞ°Ñ€Ğ¸ĞºĞ¾Ğ². Ğ¡ ÑÑ‚Ğ¾Ğ¹ Ñ†ĞµĞ»ÑŒÑ Ğ¾Ğ½Ğ¸ Ğ¿Ñ€Ğ¸Ğ³Ğ»Ğ°ÑĞ¸Ğ»Ğ¸ ğ‘›
Ğ´Ğ¾Ğ±Ñ€Ğ¾Ğ²Ğ¾Ğ»ÑŒĞ½Ñ‹Ñ… Ğ¿Ğ¾Ğ¼Ğ¾Ñ‰Ğ½Ğ¸ĞºĞ¾Ğ², ğ‘–-Ğ¹ ÑÑ€ĞµĞ´Ğ¸ ĞºĞ¾Ñ‚Ğ¾Ñ€Ñ‹Ñ… Ğ½Ğ°Ğ´ÑƒĞ²Ğ°ĞµÑ‚ ÑˆĞ°Ñ€Ğ¸Ğº Ğ·Ğ° ğ‘¡ğ‘– Ğ¼Ğ¸Ğ½ÑƒÑ‚, Ğ¾Ğ´Ğ½Ğ°ĞºĞ¾ ĞºĞ°Ğ¶Ğ´Ñ‹Ğ¹ Ñ€Ğ°Ğ· Ğ¿Ğ¾ÑĞ»Ğµ Ğ½Ğ°Ğ´ÑƒĞ²Ğ°Ğ½Ğ¸Ñ ğ‘§ğ‘– ÑˆĞ°Ñ€Ğ¸ĞºĞ¾Ğ²
ÑƒÑÑ‚Ğ°ĞµÑ‚ Ğ¸ Ğ¾Ñ‚Ğ´Ñ‹Ñ…Ğ°ĞµÑ‚ ğ‘¦ğ‘– Ğ¼Ğ¸Ğ½ÑƒÑ‚. Ğ¢ĞµĞ¿ĞµÑ€ÑŒ Ğ¾Ñ€Ğ³Ğ°Ğ½Ğ¸Ğ·Ğ°Ñ‚Ğ¾Ñ€Ñ‹ Ğ¿Ñ€Ğ°Ğ·Ğ´Ğ½Ğ¸ĞºĞ° Ñ…Ğ¾Ñ‚ÑÑ‚ ÑƒĞ·Ğ½Ğ°Ñ‚ÑŒ, Ñ‡ĞµÑ€ĞµĞ· ĞºĞ°ĞºĞ¾Ğµ Ğ²Ñ€ĞµĞ¼Ñ Ğ±ÑƒĞ´ÑƒÑ‚ Ğ½Ğ°Ğ´ÑƒÑ‚Ñ‹ Ğ²ÑĞµ ÑˆĞ°Ñ€Ğ¸ĞºĞ¸ Ğ¿Ñ€Ğ¸
Ğ½Ğ°Ğ¸Ğ±Ğ¾Ğ»ĞµĞµ Ğ¾Ğ¿Ñ‚Ğ¸Ğ¼Ğ°Ğ»ÑŒĞ½Ğ¾Ğ¹ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğµ Ğ¿Ğ¾Ğ¼Ğ¾Ñ‰Ğ½Ğ¸ĞºĞ¾Ğ², Ğ¸ ÑĞºĞ¾Ğ»ÑŒĞºĞ¾ ÑˆĞ°Ñ€Ğ¸ĞºĞ¾Ğ² Ğ½Ğ°Ğ´ÑƒĞµÑ‚ ĞºĞ°Ğ¶Ğ´Ñ‹Ğ¹ Ğ¸Ğ· Ğ½Ğ¸Ñ…. (Ğ•ÑĞ»Ğ¸ Ğ¿Ğ¾Ğ¼Ğ¾Ñ‰Ğ½Ğ¸Ğº Ğ½Ğ°Ğ´ÑƒĞ» ÑˆĞ°Ñ€Ğ¸Ğº, Ğ¸ Ğ´Ğ¾Ğ»Ğ¶ĞµĞ½
Ğ¾Ñ‚Ğ´Ğ¾Ñ…Ğ½ÑƒÑ‚ÑŒ, Ğ½Ğ¾ Ğ±Ğ¾Ğ»ÑŒÑˆĞµ ÑˆĞ°Ñ€Ğ¸ĞºĞ¾Ğ² ĞµĞ¼Ñƒ Ğ½Ğ°Ğ´ÑƒĞ²Ğ°Ñ‚ÑŒ Ğ½Ğµ Ğ¿Ñ€Ğ¸Ğ´ĞµÑ‚ÑÑ, Ñ‚Ğ¾ ÑÑ‡Ğ¸Ñ‚Ğ°ĞµÑ‚ÑÑ, Ñ‡Ñ‚Ğ¾ Ğ¾Ğ½ Ğ·Ğ°ĞºĞ¾Ğ½Ñ‡Ğ¸Ğ» Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñƒ ÑÑ€Ğ°Ğ·Ñƒ Ğ¿Ğ¾ÑĞ»Ğµ Ğ¾ĞºĞ¾Ğ½Ñ‡Ğ°Ğ½Ğ¸Ñ
Ğ½Ğ°Ğ´ÑƒĞ²Ğ°Ğ½Ğ¸Ñ Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ½ĞµĞ³Ğ¾ ÑˆĞ°Ñ€Ğ¸ĞºĞ°, Ğ° Ğ½Ğµ Ğ¿Ğ¾ÑĞ»Ğµ Ğ¾Ñ‚Ğ´Ñ‹Ñ…Ğ°).

Ğ’Ñ…Ğ¾Ğ´Ğ½Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ
Ğ’ Ğ¿ĞµÑ€Ğ²Ğ¾Ğ¹ ÑÑ‚Ñ€Ğ¾ĞºĞµ Ğ²Ñ…Ğ¾Ğ´Ğ½Ñ‹Ñ… Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ·Ğ°Ğ´Ğ°ÑÑ‚ÑÑ Ñ‡Ğ¸ÑĞ»Ğ° ğ‘š Ğ¸ ğ‘› (0â‰¤ğ‘šâ‰¤15000,1â‰¤ğ‘›â‰¤1000). Ğ¡Ğ»ĞµĞ´ÑƒÑÑ‰Ğ¸Ğµ ğ‘› ÑÑ‚Ñ€Ğ¾Ğº ÑĞ¾Ğ´ĞµÑ€Ğ¶Ğ°Ñ‚ Ğ¿Ğ¾ Ñ‚Ñ€Ğ¸ Ñ†ĞµĞ»Ñ‹Ñ…
Ñ‡Ğ¸ÑĞ»Ğ° â€” ğ‘¡ğ‘–, ğ‘§ğ‘– Ğ¸ ğ‘¦ğ‘– ÑĞ¾Ğ¾Ñ‚Ğ²ĞµÑ‚ÑÑ‚Ğ²ĞµĞ½Ğ½Ğ¾ (1â‰¤ğ‘¡ğ‘–,ğ‘¦ğ‘–â‰¤100,1â‰¤ğ‘§ğ‘–â‰¤1000).

Ğ’Ñ‹Ñ…Ğ¾Ğ´Ğ½Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ
Ğ’Ñ‹Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ğ² Ğ¿ĞµÑ€Ğ²Ğ¾Ğ¹ ÑÑ‚Ñ€Ğ¾ĞºĞµ Ñ‡Ğ¸ÑĞ»Ğ¾ ğ‘‡ â€” Ğ²Ñ€ĞµĞ¼Ñ, Ğ·Ğ° ĞºĞ¾Ñ‚Ğ¾Ñ€Ğ¾Ğµ Ğ±ÑƒĞ´ÑƒÑ‚ Ğ½Ğ°Ğ´ÑƒÑ‚Ñ‹ Ğ²ÑĞµ ÑˆĞ°Ñ€Ğ¸ĞºĞ¸. Ğ’Ğ¾ Ğ²Ñ‚Ğ¾Ñ€Ğ¾Ğ¹ ÑÑ‚Ñ€Ğ¾ĞºĞµ Ğ²Ñ‹Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ ğ‘› Ñ‡Ğ¸ÑĞµĞ» â€”
ĞºĞ¾Ğ»Ğ¸Ñ‡ĞµÑÑ‚Ğ²Ğ¾ ÑˆĞ°Ñ€Ğ¸ĞºĞ¾Ğ², Ğ½Ğ°Ğ´ÑƒÑ‚Ñ‹Ñ… ĞºĞ°Ğ¶Ğ´Ñ‹Ğ¼ Ğ¸Ğ· Ğ¿Ñ€Ğ¸Ğ³Ğ»Ğ°ÑˆĞµĞ½Ğ½Ñ‹Ñ… Ğ¿Ğ¾Ğ¼Ğ¾Ñ‰Ğ½Ğ¸ĞºĞ¾Ğ². Ğ•ÑĞ»Ğ¸ Ñ€Ğ°ÑĞ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğ¹ ÑˆĞ°Ñ€Ğ¸ĞºĞ¾Ğ² Ğ½ĞµÑĞºĞ¾Ğ»ÑŒĞºĞ¾, Ğ²Ñ‹Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ğ»ÑĞ±Ğ¾Ğµ Ğ¸Ğ·
Ğ½Ğ¸Ñ….

ĞŸÑ€Ğ¸Ğ¼ĞµÑ€
Ğ²Ñ…Ğ¾Ğ´Ğ½Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ
1 2
2 1 1
1 1 2
Ğ²Ñ‹Ñ…Ğ¾Ğ´Ğ½Ñ‹Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğµ
1
0 1
'''

'''
1  2  3  ...  zi  0
ti ti ti      ti  yi

(1 Ğ±Ğ»Ğ¾Ğº) zi * ti + yi - Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ Ğ½Ğ°Ğ´ÑƒÑ‚ÑŒ zi ÑˆĞ°Ñ€Ğ¸ĞºĞ¾Ğ²

xi / zi - Ğ¿Ñ€Ğ¾Ğ´ĞµĞ»Ğ°ĞµĞ¼ Ğ±Ğ»Ğ¾ĞºĞ¸ 
xi = 10, zi = 3

   3         3         3       1 
1 Ğ±Ğ»Ğ¾Ğº    2 Ğ±Ğ»Ğ¾Ğº    3 Ğ±Ğ»Ğ¾Ğº   

xi / zi * Ğ±Ğ»Ğ¾Ğº + (xi % zi) * ti
ĞµÑĞ»Ğ¸ xi % zi = 0, Ñ‚Ğ¾ Ñ„Ğ¾Ñ€Ğ¼ÑƒĞ»Ğ° Ğ±ÑƒĞ´ĞµÑ‚ Ğ²Ğ¾Ñ‚ Ñ‚Ğ°ĞºĞ°Ñ xi / zi * Ğ±Ğ»Ğ¾Ğº - yi (Ñ‡Ñ‚Ğ¾Ğ±Ñ‹ Ğ½Ğµ Ğ¾Ñ‚Ğ´Ñ‹Ñ…Ğ°Ñ‚ÑŒ Ğ¿Ğ¾ÑĞ»Ğµ Ğ¿Ğ¾ÑĞ»ĞµĞ´Ğ½ĞµĞ³Ğ¾ ÑˆĞ°Ñ€Ğ°)

x1 + x2 + ... + xn >= m
'''

def getCnt(T:int, t:int, z:int, y:int) -> int:
    cnt = 0
    block = z * t + y
    cntBlocks = T // block
    cnt += cntBlocks * z
    cnt += min((T % block) // t, z)
    return cnt

def ok(T:int, t:[], z:[], y:[]) -> bool:
    res = 0
    for i in range(len(t)):
        res += getCnt(T, t[i], z[i], y[i])
    return res

m, n = map(int, input().split())
t = []
z = []
y = []
for i in range(n):
    x1, x2, x3 = map(int, input().split())
    t.append(x1)
    z.append(x2)
    y.append(x3)

l = 0
r = 10**18
T = 0
while l <= r:
    mid = (l + r) // 2
    if ok(mid, t, z, y) >= m:
        r = mid - 1
        T = mid
    else:
        l = mid + 1
print(T)
for i in range(n):
    cnt = getCnt(T, t[i], z[i], y[i])
    print(min(m, cnt), end=' ')
    m -= cnt
    m = max(m, 0)